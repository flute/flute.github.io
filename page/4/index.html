<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Ludis"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Ludis"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="https://ldsun.com/"><meta property="og:site_name" content="Hexo"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://ldsun.com/img/og_image.png"><meta property="article:author" content="Ludis"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ldsun.com"},"headline":"Hexo","image":["https://ldsun.com/img/og_image.png"],"author":{"@type":"Person","name":"Ludis"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"https://ldsun.com/img/facvion.png"}},"description":""}</script><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/facvion.png" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/flute"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-29T21:15:53.000Z" title="1/30/2018, 5:15:53 AM">2018-01-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:05:53.000Z" title="2/13/2018, 3:05:53 PM">2018-02-13</time></span><span class="level-item">6 minutes read (About 920 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/30/Golang-channel/">Golang channel</a></h1><div class="content"><h3 id="1、什么是-channel（管道-通道）"><a href="#1、什么是-channel（管道-通道）" class="headerlink" title="1、什么是 channel（管道/通道）?"></a>1、什么是 channel（管道/通道）?</h3><p>在 golang 中，channel 是多个 goroutine (线程) 之间传递和同步数据的一种手段。同一时刻，仅有一个线程可以向 channel 发送数据，同样的，同一时刻也只能有一个线程能从 channel 读取数据。</p>
<p>channel 的特性使得它可以解决并发编程可能造成的死锁问题，同时也是 <code>Mutex</code> (上锁)及 <code>sync</code> 多线程编程的替代方案，可以简化代码结构。</p>
<h3 id="2、channel-的声明方式"><a href="#2、channel-的声明方式" class="headerlink" title="2、channel 的声明方式"></a>2、channel 的声明方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var c chan int  // var 关键字声明，缓冲int类型数据</span><br><span class="line">var c chan string // 缓冲string类型数据</span><br><span class="line">c := make(chan int) //  make关键字声明，非缓冲管道</span><br><span class="line">c := make(chan int, 10) // 缓冲管道</span><br><span class="line">type ChanInt chan int // 设置别名</span><br></pre></td></tr></table></figure>
<p>总结为：</p>
<ul>
<li>通过 <code>chan</code> 关键字标识为管道</li>
<li>有两种声明方式</li>
<li><code>make</code> 方式可以生成<strong>缓冲管道</strong>及<strong>非缓冲管道</strong></li>
</ul>
<h3 id="3、缓冲-channel-和无缓冲-channel-区别？"><a href="#3、缓冲-channel-和无缓冲-channel-区别？" class="headerlink" title="3、缓冲 channel 和无缓冲 channel 区别？"></a>3、缓冲 channel 和无缓冲 channel 区别？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">channel1 := make(chan int) // 无缓冲</span><br><span class="line">channel2 := make(chan int, 2) // 有缓冲</span><br><span class="line">len(channel1)   // 长度</span><br><span class="line">cap(channel2)   // 容量</span><br></pre></td></tr></table></figure>
<p><strong>无缓冲：</strong><br>缓冲为1，最多只能缓冲1个数据。无缓冲的读写实际为同步操作，只有当写与读操作匹配时，才会继续，否则会死锁！所以不能同时将读写置于主线程，如果主线程中有读/写操作，必须置于分线程的声明后，以下为三种正确的写法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">c := make(chan int)</span><br><span class="line"></span><br><span class="line">// 1</span><br><span class="line">go func() &#123;</span><br><span class="line">    &lt;-</span><br><span class="line">&#125;</span><br><span class="line">c &lt;- 1</span><br><span class="line"></span><br><span class="line">// 2</span><br><span class="line">go func() &#123;</span><br><span class="line">    c &lt;- 1</span><br><span class="line">&#125;</span><br><span class="line">&lt;-c</span><br><span class="line"></span><br><span class="line">// 3</span><br><span class="line">go func() &#123;</span><br><span class="line">    c &lt;- 1</span><br><span class="line">&#125;</span><br><span class="line">go func() &#123;</span><br><span class="line">    &lt;-c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre class="text">
非缓冲的读和写操作必须“相遇”才能执行，否则会**阻塞**。就是一个送信人去你家门口送信 ，你不在家 他不走，你一定要接下信，他才会走
</pre>
<p><strong>有缓冲：</strong><br>最大缓冲等于容量，相当于一个先进先出的队列。有缓冲的管道，只有当管道容量已存满，再未取走值的情况下继续放值时才会发生阻塞。</p>
<h3 id="4、巧用-channel"><a href="#4、巧用-channel" class="headerlink" title="4、巧用 channel"></a>4、巧用 channel</h3><p>通过 channel 的某些奇技淫巧，可以替代 <code>sync</code>，简化代码量，如下示例：</p>
<p>1、 在一个非缓冲管道中，依次循环存入值，并逐个取出</p>
<p><code>sync</code>实现方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;sync&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">var wg sync.WaitGroup //队列</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	// 先创建一个非缓冲管道</span><br><span class="line">	c := make(chan int)</span><br><span class="line">	wg.Add(2)</span><br><span class="line">	go func() &#123; //子线程</span><br><span class="line">		for i := 0; i &lt; 10; i++ &#123;</span><br><span class="line">			c &lt;- i //写入数据</span><br><span class="line">			fmt.Println(&quot;写入数据&quot;)</span><br><span class="line">		&#125;</span><br><span class="line">		wg.Done()</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		for i := 0; i &lt; 10; i++ &#123;</span><br><span class="line">			a := &lt;-c</span><br><span class="line">			fmt.Println(a) //读取数据</span><br><span class="line">			fmt.Println(&quot;读取数据&quot;)</span><br><span class="line">		&#125;</span><br><span class="line">		wg.Done()</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	wg.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>=&gt; 使用 <code>channel</code> 实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    c := make(chan int)</span><br><span class="line">    go func() &#123;</span><br><span class="line">        for i:=10; i&lt;10; i++ &#123;</span><br><span class="line">            fmt.Println(&quot;------&quot;)</span><br><span class="line">            c &lt;- i</span><br><span class="line">        &#125;</span><br><span class="line">        close(c)</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    for n := range c &#123;</span><br><span class="line">        fmt.Println(&quot;+++++&quot;)</span><br><span class="line">        fmt.Println(n)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注：<code>for n := range n</code> 和 <code>close(c)</code> 配合使用，成对出现。<code>for</code> 循环会监视管道c，一旦管道中有数据，立即执行循环中的命令，取出值，直到 <code>close(c)</code> 命令关闭管道，循环结束</p>
<p>2、 等待多个分线程执行完毕再关闭通道——巧用多个 <code>channel</code> </p>
<p><code>sync</code> 实现方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;sync&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	c := make(chan int) //创建通道</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup //队列</span><br><span class="line">	wg.Add(2)</span><br><span class="line">	go func() &#123;</span><br><span class="line">		fmt.Println(&quot;111111111&quot;)</span><br><span class="line"></span><br><span class="line">		for i := 0; i &lt; 10; i++ &#123;</span><br><span class="line">			c &lt;- i</span><br><span class="line">		&#125;</span><br><span class="line">		wg.Done()</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		fmt.Println(&quot;22222222&quot;)</span><br><span class="line">		for i := 10; i &lt; 20; i++ &#123;</span><br><span class="line">			c &lt;- i</span><br><span class="line">		&#125;</span><br><span class="line">		wg.Done()</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		fmt.Println(&quot;33333333&quot;)</span><br><span class="line">		wg.Wait()</span><br><span class="line">		close(c)</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	for n := range c &#123;</span><br><span class="line"></span><br><span class="line">		// &lt;-c  有返回值</span><br><span class="line">		fmt.Println(n)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>=&gt; <code>channel</code> 解决方案：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	c := make(chan int)</span><br><span class="line">	done := make(chan bool)</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		for i := 0; i &lt; 10; i++ &#123;</span><br><span class="line">			c &lt;- i</span><br><span class="line">		&#125;</span><br><span class="line">		done &lt;- true</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		for i := 0; i &lt; 10; i++ &#123;</span><br><span class="line">			c &lt;- i</span><br><span class="line">		&#125;</span><br><span class="line">		done &lt;- true</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">	   &lt;-done //死锁</span><br><span class="line">	   &lt;-done</span><br><span class="line">	   close(c)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	for n := range c &#123;</span><br><span class="line">		fmt.Println(n)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-26T19:45:01.000Z" title="1/27/2018, 3:45:01 AM">2018-01-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:05:01.000Z" title="2/13/2018, 3:05:01 PM">2018-02-13</time></span><span class="level-item">6 minutes read (About 906 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/27/Golang%E6%8C%87%E9%92%88/">Golang指针</a></h1><div class="content"><p>golang中的指针与c语言指针略有不同。</p>
<p><strong>1、基本类型的指针</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var num int = 10</span><br><span class="line">var p *int = &amp;num   // 指针的类型为所指向的变量的类型前加*</span><br></pre></td></tr></table></figure>

<p><strong>2、数组的指针与指针数组</strong></p>
<p>数组的指针：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr := [3]int&#123;1, 2, 3&#125;</span><br><span class="line">var arrp *[3]int  // 数组的指针</span><br><span class="line">a := &amp;arr   // 直接取数组变量的地址赋值会报错（arrp = &amp;arr）</span><br><span class="line">arrp = a   // 通过第三个变量传递</span><br></pre></td></tr></table></figure>

<p>指针数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr := [3]*int&#123;&#125;</span><br><span class="line">numArr := [3]int&#123;1, 2, 3&#125;</span><br><span class="line">for i, v := range numArr &#123;</span><br><span class="line">    arr[i] = &amp;v</span><br><span class="line">    fmt.Println(*arr[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3、字典的指针</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">maps := map[string]string&#123;</span><br><span class="line">    &quot;name&quot; : &quot;ludis&quot;,</span><br><span class="line">    &quot;age&quot;: &quot;18&quot;,</span><br><span class="line">&#125;</span><br><span class="line">var p *map[string]string = &amp;maps // 字典可直接取地址赋值给指针变量，不同于数组，需要通过中间变量</span><br><span class="line">fmt.Println((*p)[&quot;name&quot;])   // 取值时*指针变量需要括号括起来</span><br></pre></td></tr></table></figure>

<p><strong>4、函数的指针与指针函数</strong></p>
<p>函数的指针：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">func main &#123;</span><br><span class="line">    fmt.Println(add)  // 0x1093c40</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func add() &#123;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>函数声明后，函数名变量本身就是指针类型，存储的是指向函数体的地址。</li>
<li>因此当对函数变量赋值给其他变量时，属于浅拷贝，只是拷贝指向函数的地址。</li>
</ul>
<p>指针函数：指针函数与结构体方法类似，见下。</p>
<p><strong>5、 结构体的指针</strong></p>
<p>结构体创建对象：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">type Person struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    // var关键字声明对象</span><br><span class="line">    var person1 = Person&#123;</span><br><span class="line">        &quot;佩奇&quot;,</span><br><span class="line">        &quot;3&quot;,</span><br><span class="line">    &#125; </span><br><span class="line">    // := 简写声明</span><br><span class="line">    person2 := Person&#123;</span><br><span class="line">        &quot;佩奇粑粑&quot;,</span><br><span class="line">        &quot;28&quot;,</span><br><span class="line">    &#125;</span><br><span class="line">    // new关键字声明</span><br><span class="line">    var person3 = new(Person) // 等同于 person3 := &amp;Person&#123;&quot;佩奇麻麻&quot;, &quot;26&quot;&#125;</span><br><span class="line">    person3.name = &quot;佩奇麻麻&quot; </span><br><span class="line">    person3.age = &quot;26&quot;</span><br><span class="line">    </span><br><span class="line">    fmt.Println(person1, person2, person3) // &#123;佩奇 3&#125; &#123;佩奇粑粑 28&#125; &amp;&#123;佩奇麻麻 26&#125;</span><br><span class="line">    </span><br><span class="line">    p1 := person1</span><br><span class="line">    p2 := person2</span><br><span class="line">    p3 := person3</span><br><span class="line">    p1.name = &quot;猪宝宝&quot;</span><br><span class="line">    p1.name = &quot;猪爹&quot;</span><br><span class="line">    p1.name = &quot;猪妈&quot;</span><br><span class="line">    fmt.Println(person1, person2, person3) // &#123;佩奇 3&#125; &#123;佩奇粑粑 28&#125; &amp;&#123;猪妈 26&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>从结果可以看出：</p>
<ul>
<li>前两种声明方式创建，变量中直接存储的是对象，对其进行拷贝为深拷贝。</li>
<li>使用new创建，变量中存储的是地址，对其拷贝为浅拷贝。</li>
</ul>
<p>结构体的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">type Person struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p Person) setName() &#123;</span><br><span class="line">    p.name = &quot;小猪佩奇&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *Person) setAge(age int) &#123;</span><br><span class="line">    p.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    // var关键字声明对象， 等同于:=声明</span><br><span class="line">    var person = Person&#123;&quot;佩奇&quot;, 3&#125; </span><br><span class="line">    fmt.Println(person.name, person.age) // 佩奇 3</span><br><span class="line">    person.setName()</span><br><span class="line">    person.setAge(6)</span><br><span class="line">    fmt.Println(person.name, person.age) // 佩奇 6</span><br><span class="line">    // new 声明</span><br><span class="line">    pigone :=  new(Person) // 🌚 not pgone</span><br><span class="line">    pigone.name = &quot;pig&quot;</span><br><span class="line">    pigone.age = 69</span><br><span class="line">    fmt.Println(pigone) // &amp;&#123;pig 69&#125;</span><br><span class="line">    pigone.setName()</span><br><span class="line">    pigone.setAge(96)</span><br><span class="line">    fmt.Println(pigone) // &amp;&#123;pig 96&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由结果可知：</p>
<ul>
<li>结构体的方法，如果传入的值为对象类型时（setName声明方式），不管传入的是值类型（对象）还是引用类型（指针），在方法中都会深拷贝传入的对象，修改值后传入的对象不收影响。</li>
<li>如果结构体方法传传参类型为指针类型时（setAge声明方式）,不管传入的是什么类型，都属于浅拷贝，修改值影响传入的对象。</li>
</ul>
<p><strong>6、interface 接口</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">// 结构体</span><br><span class="line">type Person struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 结构体方法</span><br><span class="line">func (p Person) fun1 &#123;</span><br><span class="line">    p.name = &quot;大猪&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *Person) fun2 &#123;</span><br><span class="line">    p.name = &quot;小猪&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 接口</span><br><span class="line">type PersonInfo interface &#123;</span><br><span class="line">    fun1()</span><br><span class="line">    fun2()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    person := Person&#123;&quot;猪猪侠&quot;, 9&#125;</span><br><span class="line">    person1 := new(Person)</span><br><span class="line">    var p PersonInfo = person // 报错</span><br><span class="line">    var p PersonInfo = &amp;person // 正确</span><br><span class="line">    var p PersonInfo = person1 // 正确</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结论：</p>
<ul>
<li>声明接口时，接口中的函数必须在结构体中有声明</li>
<li>当结构体的方法中，有一个（最少一个）是引用类型（传递指针）的方法时，那么给接口变量赋值时，必须使用引用类型！</li>
</ul>
<p>END🤔</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-25T20:54:25.000Z" title="1/26/2018, 4:54:25 AM">2018-01-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:04:25.000Z" title="2/13/2018, 3:04:25 PM">2018-02-13</time></span><span class="level-item">7 minutes read (About 1056 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/26/Golang%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E3%80%81%E4%B8%B2%E8%A1%8C%E7%BC%96%E7%A8%8B/">Golang并发编程、串行编程</a></h1><div class="content"><h3 id="线程概要"><a href="#线程概要" class="headerlink" title="线程概要"></a>线程概要</h3><p><strong>1、什么是进程，线程，多线程？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">开个QQ，开了一个进程；开了迅雷，开了一个进程。</span><br><span class="line">在QQ的这个进程里，传输文字开一个线程、传输语音开了一个线程、弹出对话框又开了一个线程。</span><br><span class="line">所以运行某个软件，相当于开了一个进程。在这个软件运行的过程里（在这个进程里），多个工作支撑的完成QQ的运行，那么这“多个工作”分别有一个线程。</span><br><span class="line">所以一个进程管着多个线程。</span><br><span class="line">通俗的讲：“进程是爹妈，管着众多的线程儿子”...</span><br></pre></td></tr></table></figure>

<p>进程： 一个正在运行的程序一般就是一个进程，一个进程中可以有多个线程<br>线程：一条有序的CPU命令的集合体<br>多线程：多条有序CPU命令的集合体</p>
<p>备注：一个CPU在同一时刻只能执行一个CPU命令</p>
<p><strong>2、一个CPU可以并发编程（多线程）吗？</strong></p>
<p>例如：3个线程：（上下文切换-&gt;线程切换（时间片轮转）） 并发编程<br>线程1： 5个命令<br>线程2： 3个命令<br>线程3： 8个命令</p>
<p>线程1、线程2、线程3在一个CPU的情况下，进行并发编程，由于CPU在同一时间只能执行一个命令，<br>所以需要通过时间片的轮转</p>
<p><strong>3、并发/并行编程、串行编程</strong><br>并发编程：多个线程，会有时间片的分配问题，多个线程之间会不断的来回切换<br>串行编程：按照顺序一一的去执行</p>
<p><strong>4、CPU有分类：</strong><br>CPU分为两种：物理CPU、逻辑CPU</p>
<ul>
<li>一个物理CPU可以虚拟出多个逻辑CPU（多核）</li>
<li>8核同一时刻可以最多执行八个cup命令</li>
</ul>
<p>5、多线程编程优缺点：<br>优点：分线程可以处理耗时操作，不会出现主线程阻塞<br>缺点：资源竞争，内存消耗，死锁</p>
<h3 id="golang多线程"><a href="#golang多线程" class="headerlink" title="golang多线程"></a>golang多线程</h3><p><strong>1、创建多线程：</strong></p>
<ul>
<li>多线程通过 go 关键字创建分线程</li>
<li>引入 <code>sync</code> 库控制多线程，<code>var wg sync.WaitGroup</code> 创建实例。<ul>
<li><code>wg.Add()</code> 方法声明分线程数。</li>
<li><code>wg.Wait()</code> 方法等待声明的线程全部执行完时（线程数为0时），才会执行后续代码； 在每个分线程。</li>
<li><code>wg.Done()</code> 表示该分线程执行结束，告知主线程（每当分线程执行结束，<code>wg.Add()</code> 声明的线程数减一）。</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    wg.Add(<span class="number">2</span>) <span class="comment">// 添加两个线程</span></span><br><span class="line">    <span class="keyword">go</span> f1()</span><br><span class="line">    <span class="keyword">go</span> f2()</span><br><span class="line">    wg.Wait() <span class="comment">// 等待所有添加的线程执行结束 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f1</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++ &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;f1&quot;</span>, i)</span><br><span class="line">        time.Sleep(<span class="number">1</span> * time.Seconed) <span class="comment">// 等待2s</span></span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done() <span class="comment">// 当前分线程执行结束，通知主线程</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="number">200</span>; i++ &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;f2&quot;</span>, i)</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done() <span class="comment">// 当前分线程执行结束，通知主线程</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2、资源竞争、上锁</strong></p>
<p>并发编程由于是CPU在多个线程建来回切换，如果多个线程对同一全局变量进行操作，则无法预测出现的结果（因为CPU在多线程间的切换是随机的）。这时就需要对数据进行上锁，即同一时刻，同一数据只能被一个线程操作。当操作时对该数据上锁，在此期间，其他线程无法操作该数据，只能等待。当该数据的操作完成时，再对其进行解锁，这样等待中的其他线程就可以操作该数据。</p>
<p>检测资源竞争：<code>go run -race main.go</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;math/rand&quot; // 随机数</span><br><span class="line">    &quot;time&quot;</span><br><span class="line">    &quot;sync&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">var wg sync.WaitGroup</span><br><span class="line">var counter int</span><br><span class="line">var mutex sync.Mutex    // 上锁、解锁</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    wg.Add(2)</span><br><span class="line">    incrementor(&quot;Foo:&quot;)</span><br><span class="line">    incrementor(&quot;Bar:&quot;)</span><br><span class="line">    wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func incrementor(s string) &#123;</span><br><span class="line">    rand.Seed(time.Now().UnixNano())</span><br><span class="line">    for i:=0; i&lt;20; i++ &#123;</span><br><span class="line">        time.Sleep(time.Duration(rand.Intn(3)) * time.Millisecond)</span><br><span class="line">        mutex.Lock() // 上锁</span><br><span class="line">        counter ++ </span><br><span class="line">        fmt.Println(s, i, &quot;counter:&quot;, counter)</span><br><span class="line">        mutex.Unlock() // 解锁</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-22T21:13:49.000Z" title="1/23/2018, 5:13:49 AM">2018-01-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:03:49.000Z" title="2/13/2018, 3:03:49 PM">2018-02-13</time></span><span class="level-item">7 minutes read (About 975 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/23/Golang%E6%95%B0%E7%BB%84%E3%80%81map%E3%80%81%E5%87%BD%E6%95%B0%E5%8F%8A%E7%B1%BB/">Golang数组、map、函数及类</a></h1><div class="content"><h2 id="数组-切片"><a href="#数组-切片" class="headerlink" title="数组/切片"></a>数组/切片</h2><p>数组声明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">普通声明：</span><br><span class="line">var arr = [5]int&#123;&#125; // 长度固定为5，不可扩展，&#123;&#125;中为初始值，默认为0</span><br><span class="line">arr := [5]string&#123;&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;&#125;</span><br><span class="line">var arr [5]int // [0, 0, 0, 0]</span><br><span class="line"></span><br><span class="line">make关键字声明数组切片：</span><br><span class="line">var arr = make([], 2, 4) // 长度 len(arr) 为2，容量 cap(arr) 为4，长度决定存储量，容量不够时翻倍</span><br><span class="line">arr := make([], 1, 1)</span><br><span class="line">arr = append(arr, 1)    // len(arr)=1 cap(arr)=1</span><br><span class="line">arr = append(arr, 2)    // len(arr)=2 cap(arr)=2</span><br><span class="line">arr = append(arr, 3)    // len(arr)=3 cap(arr)=4</span><br><span class="line"></span><br><span class="line">截取、拼接数组：</span><br><span class="line">arr1 :=[]int&#123;1, 2, 3, 4, 5, 6&#125;</span><br><span class="line">arr2 :=[]int&#123;7, 8, 9&#125;</span><br><span class="line">arr1[:3] // 等价于arr1[0:3] =&gt; [1, 2, 3]</span><br><span class="line">arr1[3:] // 等价于arr[3:5] =&gt; [4, 5, 6]</span><br><span class="line">arr1 = append(arr1, arr2...) // arr1 = [1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line"></span><br><span class="line">二维数组：</span><br><span class="line">var arr = [2][2]int&#123;&#125; // [[0, 0], [0, 0]]</span><br><span class="line"></span><br><span class="line">遍历：</span><br><span class="line">for index, value := range arr &#123;</span><br><span class="line">    fmt.Println(index, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>区别于 javascript:</p>
<ul>
<li>数组中只能存储相同类型的值</li>
<li>只有make关键字声明的切片长度可变</li>
</ul>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>map字典，对应于javascript中的对象，即为键值对的集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">普通声明方式：</span><br><span class="line">var map = map[string]string&#123;</span><br><span class="line">    &quot;name&quot;: &quot;ludis&quot;,</span><br><span class="line">    &quot;age&quot;: &quot;18&quot;,</span><br><span class="line">&#125;</span><br><span class="line">map := map[int]string&#123;</span><br><span class="line">    1: &quot;first&quot;,</span><br><span class="line">    2: &quot;second&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">make关键字声明：</span><br><span class="line">var map = make(map[string]string) // map == nil</span><br><span class="line">map[&quot;name&quot;] = &quot;ludis&quot; // 赋值</span><br><span class="line">delete(map, &quot;name&quot;)   // 删除</span><br><span class="line">// 判断是否存在某属性</span><br><span class="line">if val, ok := map[&quot;name&quot;]; ok &#123;</span><br><span class="line">	fmt.Println(val)</span><br><span class="line">	fmt.Println(ok)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">遍历:</span><br><span class="line">for _,value := range map&#123;</span><br><span class="line">    fmt.Println(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">三种函数声明方式：</span><br><span class="line">func function(name string, age int) string&#123;</span><br><span class="line">    reutrn name+string(int)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var function = func(name string, age int) string&#123;</span><br><span class="line">    reutrn name+string(int)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function := func(name string, age int) string&#123;</span><br><span class="line">    reutrn name+string(int)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">函数类型为：(去掉函数名及变量名)</span><br><span class="line">func(string, int) string</span><br><span class="line"></span><br><span class="line">1、通过func关键字声明的为全局函数，等同于用var声明的全局函数，不能再函数体内用func声明函数</span><br><span class="line">2、在函数体内声明局部函数的方法为 := 简写方式</span><br><span class="line">3、函数声明会提升，变量声明不会提升</span><br><span class="line"></span><br><span class="line">回调函数/函数作为参数、函数作为返回值：</span><br><span class="line">func getUserName(name string, f func(name string, age int))&#123;</span><br><span class="line">    f(name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getUserName(name string) func(string)&#123;</span><br><span class="line">    return func(name string)&#123;</span><br><span class="line">        fmt.Println(name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="类与继承、复合、重写"><a href="#类与继承、复合、重写" class="headerlink" title="类与继承、复合、重写"></a>类与继承、复合、重写</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">类的定义：通过关键字 type 定义</span><br><span class="line">type Animal struct &#123;</span><br><span class="line">    age int</span><br><span class="line">    weight float64</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">类的方法定义：</span><br><span class="line">func (animal *Animal) setAge(age int)&#123;</span><br><span class="line">    animal.age = age</span><br><span class="line">&#125;</span><br><span class="line">func (animal *Animal) getWeight() float64&#123;</span><br><span class="line">    return animal.weight</span><br><span class="line">&#125;</span><br><span class="line">// 通过 (animal *Animal) 将函数与类绑定，使其成为类的方法</span><br><span class="line">// (animal Animal) 不加地址符时为深拷贝，加地址符为浅拷贝</span><br><span class="line"></span><br><span class="line">创建类的对象：</span><br><span class="line">animal := Animal&#123;18, 66.6&#125;</span><br><span class="line">animal.setAge(8)    // animal.age = 8</span><br><span class="line">fmt.Println(animal.getWeight()) // 66.6</span><br><span class="line"></span><br><span class="line">复合：(汽车有四个轮子、有品牌；轮子有半径。汽车复用轮子类)</span><br><span class="line">type Wheel struct &#123;</span><br><span class="line">    r float</span><br><span class="line">&#125;</span><br><span class="line">type Car struct &#123;</span><br><span class="line">    wheels [4]intWheel</span><br><span class="line">    brand string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wheel := Wheel&#123;66.6&#125;</span><br><span class="line">wheels := [4]Wheel&#123;wheel, wheel, wheel, wheel&#125;</span><br><span class="line">car := Car&#123;</span><br><span class="line">    wheels: wheels,</span><br><span class="line">    brand: &quot;Tesla&quot;,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Print(car)</span><br><span class="line"></span><br><span class="line">继承：（动物、狗）</span><br><span class="line">type Animal struct &#123;</span><br><span class="line">	age    int</span><br><span class="line">	weight float64</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (a *Animal) backAgeAndWeight() (int, float64) &#123;</span><br><span class="line">	return a.age, a.weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 方法重写</span><br><span class="line">func (d *Dog) backAgeAndWeight() (int, float64) &#123;</span><br><span class="line">	return d.age, d.weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Dog struct &#123;</span><br><span class="line">	// animal Animal -&gt; Animal 直接继承为自有属性</span><br><span class="line">	Animal</span><br><span class="line">	name string</span><br><span class="line">	age  int</span><br><span class="line">&#125;</span><br><span class="line">dog := Dog&#123;</span><br><span class="line">	Animal: Animal&#123;5, 6&#125;,</span><br><span class="line">	name:   &quot;二哈&quot;,</span><br><span class="line">	age:    18,</span><br><span class="line">&#125;</span><br><span class="line">// 继承</span><br><span class="line">fmt.Println(dog.age)</span><br><span class="line">// 复合-&gt;模拟继承</span><br><span class="line">fmt.Println(dog.Animal.weight)</span><br><span class="line"></span><br><span class="line">// var animal Animal = Dog&#123;&#125;</span><br><span class="line">// 父类的指针指向子类的对象 -&gt; 多态</span><br><span class="line">// go模拟继承，非正真的继承 dog.age != dog.Animal.age，通过复合模拟真正的继承</span><br><span class="line"></span><br><span class="line">fmt.Println(dog.Animal.backAgeAndWeight())</span><br><span class="line">fmt.Println(dog.backAgeAndWeight())</span><br></pre></td></tr></table></figure>
<p>go语言中的继承并非正真意义上的继承，而是通过复合的方式模拟继承，当子类继承父类后，子类创建的对象中，包含一个隐藏的父类对象，其中包括父类的属性及方法。当在子类创建的对象中定义重名的属性/方法时，并不会修改父类对象中的属性/方法，而是直接在子类创建的对象上添加，类似javascript中的原型链，当查询对象的属性/方法时，优先在对象上查找，未找到时才会去继承自父类的对象上查找。所以说golang的继承是伪继承。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-11T20:02:55.000Z" title="1/12/2018, 4:02:55 AM">2018-01-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:11:24.000Z" title="2/13/2018, 3:11:24 PM">2018-02-13</time></span><span class="level-item">4 minutes read (About 616 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/12/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0-%E8%BF%9B%E5%88%B6%E3%80%81GO%E8%BF%90%E7%AE%97%E7%AC%A6/">区块链学习-进制、GO运算符</a></h1><div class="content"><p><strong>int 与 uint 区别</strong><br>int 表示有符号整数<br>uint 表示无符号整数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int8    -128~127</span><br><span class="line">int16   -2^8~2^8</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">uint8   0~255</span><br><span class="line">uint16  0~2^16</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h4 id="十进制转二进制"><a href="#十进制转二进制" class="headerlink" title="十进制转二进制"></a>十进制转二进制</h4><p><strong>1. 正整数转二进制</strong></p>
<p> 正整数使用二除法，得到的结果倒叙即为该十位数的二进制数</p>
<p><img src="media/15156745795266/15156752014743.png"></p>
<p><strong>2. 负数转二进制</strong></p>
<p>先得到正数对应的二进制数，然后取反，再加一即为该负数的二进制数</p>
<p><strong>3. 小数转二进制</strong></p>
<ul>
<li>整数部分+小数点+小数部分</li>
<li>整数部分：按照前面的步骤正常转换</li>
<li>小数部分：小数部分乘2，得到结果的整数部分n，若小数部分不为零，继续上面的步骤。最后得到的n的排列即为小数部分</li>
</ul>
<h4 id="二进制转十进制"><a href="#二进制转十进制" class="headerlink" title="二进制转十进制"></a>二进制转十进制</h4><p><strong>1. 正二进制数</strong></p>
<p>正二进制即首位为0的二进制数，转十进制只需每位乘以2的对应次方，然后想加即可。</p>
<p><strong>2. 负二进制数</strong></p>
<p>负二进制数，首先取反，然后按正二进制数计算即可</p>
<p><strong>3. 带小数的二进制数</strong></p>
<p>小数部分每位乘的是2的对应负次方</p>
<h4 id="int8的取值范围解读"><a href="#int8的取值范围解读" class="headerlink" title="int8的取值范围解读"></a>int8的取值范围解读</h4><p>int8的取值范围是 1111 1111<del>0111 1111 ？（-127</del>127）<br>二进制类型分为<code>原码</code> <code>反码</code> <code>补码</code>，计算机为了保持数据的可分辨性（正负区别）及消除正零、负零的问题，最终采用补码形式存储数据<br>所以int8的取值范围实际为 1000 0000 ~ 0111 1111（-128~127）</p>
<p>正二进制数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反码 = 原码</span><br><span class="line">补码 = 原码</span><br></pre></td></tr></table></figure>
<p>负二进制数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反码 = 除了符号位，原码取反</span><br><span class="line">补码 = 反码+1</span><br></pre></td></tr></table></figure>

<h4 id="二进制转与八进制-十六进制等互转"><a href="#二进制转与八进制-十六进制等互转" class="headerlink" title="二进制转与八进制/十六进制等互转"></a>二进制转与八进制/十六进制等互转</h4><p>二转八:<br>二进制数从（小数点）向两侧每三位一分，不够三位的在两端用0补齐，然后每三位转为对应的八进制数即可<br>八转二：每位八进制数转为二进制即可</p>
<p>二转n进制/n转二进制<br>二转n: n进制数的最大可显示值对应的二进制位数为m，二转n进制时每m位等分即可<br>n转二: 同八转二</p>
<h4 id="Go语言运算符"><a href="#Go语言运算符" class="headerlink" title="Go语言运算符"></a>Go语言运算符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//Go语言中，以下写法错误:</span><br><span class="line">var a int = 10</span><br><span class="line">println(a++)</span><br><span class="line"></span><br><span class="line">无++a的写法</span><br></pre></td></tr></table></figure>
<p>注：（以下js/c/java…输出报错）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = 10</span><br><span class="line">console.log(++a++)</span><br><span class="line">++a 得到的是一个常量，无法为常量进行++运算</span><br></pre></td></tr></table></figure>


</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-01-10T19:01:09.000Z" title="1/11/2018, 3:01:09 AM">2018-01-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T07:09:12.000Z" title="2/13/2018, 3:09:12 PM">2018-02-13</time></span><span class="level-item">4 minutes read (About 569 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/11/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0-Golang%E5%88%9D%E5%A7%8B/">区块链学习 - Golang初始</a></h1><div class="content"><p>系统：Ubuntu 16.0.4</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><strong>下载</strong>：<a target="_blank" rel="noopener" href="https://golang.org/dl/">https://golang.org/dl/</a> 下载linux对应的版本<br><strong>解压</strong>：将源码解压至/usr/local<br><code>tar -C /usr/local -xzf go1.4.linux-amd64.tar.gz</code><br><strong>配置环境变量</strong>：<code>export PATH=$PATH:/usr/local/go/bin</code></p>
<p>检测安装：<code>go version</code> <code>go env</code></p>
<h3 id="HelloBlockChain"><a href="#HelloBlockChain" class="headerlink" title="HelloBlockChain"></a>HelloBlockChain</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> $HOME</span><br><span class="line"><span class="built_in">mkdir</span> golang &amp;&amp; <span class="keyword">cd</span> golang</span><br><span class="line"><span class="keyword">vi</span> <span class="built_in">index</span>.<span class="keyword">go</span></span><br><span class="line"></span><br><span class="line">package main</span><br><span class="line">import <span class="string">&quot;fmt&quot;</span></span><br><span class="line">func main()&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello Block Chain&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">:<span class="keyword">wq</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> run <span class="built_in">index</span>.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>
<p>package 声明主程序包<br>import  导入第三方依赖包<br>func 申明函数</p>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">var name [type] [=] [value]</span><br><span class="line"></span><br><span class="line">var number int = 1</span><br><span class="line">var str string = &quot;I`m a string&quot;</span><br><span class="line">var bools bool = true</span><br><span class="line"></span><br><span class="line">// 显式指定变量类型时，后续不能修改为其他类型的值</span><br><span class="line"></span><br><span class="line">var year,month,day</span><br><span class="line"></span><br><span class="line">year,month,day = 2018,1,10</span><br><span class="line"></span><br><span class="line">// 隐式声明变量时，会根据值自动设置类型，可以通过逗号同时给多个变量赋值</span><br><span class="line"></span><br><span class="line">first := 1</span><br><span class="line">second := 2</span><br><span class="line"></span><br><span class="line">// 可以使用冒号加等号的简写方式申明变量，等同于隐式声明变量</span><br><span class="line"></span><br><span class="line">var (</span><br><span class="line">    name = &quot;ludis&quot;</span><br><span class="line">    age int = 18</span><br><span class="line">    height</span><br><span class="line">    length</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// height = 18, length = 18</span><br><span class="line">// 可以用枚举的方式声明多个不同类型的变量</span><br><span class="line">// 当不给变量赋值时，默认继承前面第一个非空变量的值</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">常量使用const声明</span><br><span class="line"></span><br><span class="line">const WIDTH = 18</span><br><span class="line">const Height int = 18</span><br><span class="line"></span><br><span class="line">常量声明后不可修改值，其余属性与变量相同</span><br><span class="line"></span><br><span class="line">const (</span><br><span class="line">    num = iota</span><br><span class="line">    num1</span><br><span class="line">    num2 = 233</span><br><span class="line">    num3</span><br><span class="line">    num4 = iota</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// const在声明常量时必须为其赋值</span><br><span class="line">// iota为特殊类型，从0开始，每申明一个变量，自身加一，其后未赋值的常量为等于iota</span><br><span class="line">// num = 0, num1 = 1, num2 = 233, num3 = 233, num4 = 4</span><br><span class="line"></span><br><span class="line">如声明a-e分别为0-5，则可简写为：</span><br><span class="line">const (</span><br><span class="line">    a = iota</span><br><span class="line">    b</span><br><span class="line">    c</span><br><span class="line">    d</span><br><span class="line">    e</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="fmt-Printf"><a href="#fmt-Printf" class="headerlink" title="fmt.Printf()"></a>fmt.Printf()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var num int = 10</span><br><span class="line"></span><br><span class="line">十进制：fmt.Printf(&quot;%d&quot;, num)</span><br><span class="line">八进制：fmt.Printf(&quot;%o&quot;, num)</span><br><span class="line">二进制：fmt.Printf(&quot;%b&quot;, num)</span><br><span class="line">十六进制：fmt.Printf(&quot;%x&quot;, num)</span><br><span class="line">显示地址：fmt.Printf(&quot;%v&quot;, &amp;num)</span><br><span class="line"></span><br><span class="line">// 十六进制通过`x`及`X`分别输出小写及大写格式，在`x`前附带#会输出十六进制标识`0x`</span><br><span class="line">// fmt.Println 及原生 println 输出值后自动换行，fmt.Print需手动换行，原生print方法输出后面带%</span><br><span class="line">// `\n`换行  `\t`空格</span><br><span class="line">// const 声明的常量无法获得地址</span><br></pre></td></tr></table></figure>

<p>go语言中，当引用的包或申明的变量未使用时会报错（厉害了老哥，不让浪费是好事233）</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-06-05T22:05:58.000Z" title="6/6/2017, 6:05:58 AM">2017-06-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T06:58:58.000Z" title="2/13/2018, 2:58:58 PM">2018-02-13</time></span><span class="level-item">9 minutes read (About 1282 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/06/06/vue2-express%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E8%B7%A8%E5%9F%9Fsession%E7%AD%89%E9%97%AE%E9%A2%98/">vue2+express前后端分离跨域session等问题</a></h1><div class="content"><p>基于 vue2 + express 的 RBAC 角色权限验证前后端分离项目。前端vue2 负责路由控制，数据渲染，后端 express 负责数据库操作，RBAC权限控制。</p>
<p><strong>前端：</strong></p>
<ul>
<li>脚手架：vue-cli</li>
<li>选型：vue2 + vuex + vue-router + axios + iview + ES6</li>
</ul>
<p><strong>后端：</strong></p>
<ul>
<li>脚手架：express-generator</li>
<li>选型：express4 + mongodb</li>
</ul>
<p><strong>结构整合：</strong></p>
<p>使用<code>vue-cli</code>生成的项目，默认安装了简易的 express，该 express 的启动文件为<code>build/dev-server.js</code>。执行<code>cnpm start</code>启动该 express,实际主要是启一个服务来运行 Vue。所以我们后端部分不以该文件为入口。<br>后端部分的目录使用<code>express-generator</code>来生成，由于我们做了前后端分离，所以express 的任务只是提供接口，做数据库操作，所以我们把view、pubic目录删掉。<br>最后将前后端代码整合一下。在 vue-cli 生成的目录下创建 server 目录用来存放后端代码，将package.json文件合并，然后添加启动后端的脚本”server”: “node server/bin/www”</p>
<p>package.json 文件如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;backend&quot;</span>,</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;backend build by webpack+vue2+express&quot;</span>,</span><br><span class="line">  <span class="string">&quot;author&quot;</span>: <span class="string">&quot;ludis &lt;service@ldsun.com&gt;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;node build/dev-server.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="string">&quot;node build/dev-server.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;node build/build.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;eslint --ext .js,.vue src&quot;</span>,</span><br><span class="line">    <span class="string">&quot;server&quot;</span>: <span class="string">&quot;node server/bin/www&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;axios&quot;</span>: <span class="string">&quot;^0.16.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iview&quot;</span>: <span class="string">&quot;^2.0.0-rc.15&quot;</span>,</span><br><span class="line">    <span class="string">&quot;moment&quot;</span>: <span class="string">&quot;^2.18.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;monk&quot;</span>: <span class="string">&quot;^5.0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue&quot;</span>: <span class="string">&quot;^2.3.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-awesome&quot;</span>: <span class="string">&quot;^2.3.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-axios&quot;</span>: <span class="string">&quot;^2.0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-router&quot;</span>: <span class="string">&quot;^2.3.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vuex&quot;</span>: <span class="string">&quot;^2.3.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;async&quot;</span>: <span class="string">&quot;^2.1.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cors&quot;</span>: <span class="string">&quot;^2.8.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;body-parser&quot;</span>: <span class="string">&quot;~1.15.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cookie-parser&quot;</span>: <span class="string">&quot;~1.4.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;debug&quot;</span>: <span class="string">&quot;~2.2.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;express&quot;</span>: <span class="string">&quot;~4.13.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;express-session&quot;</span>: <span class="string">&quot;latest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;formidable&quot;</span>: <span class="string">&quot;^1.1.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;morgan&quot;</span>: <span class="string">&quot;~1.7.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;autoprefixer&quot;</span>: <span class="string">&quot;^6.7.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-core&quot;</span>: <span class="string">&quot;^6.22.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-eslint&quot;</span>: <span class="string">&quot;^7.1.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-loader&quot;</span>: <span class="string">&quot;^6.2.10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-plugin-transform-runtime&quot;</span>: <span class="string">&quot;^6.22.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-preset-env&quot;</span>: <span class="string">&quot;^1.3.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-preset-stage-2&quot;</span>: <span class="string">&quot;^6.22.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babel-register&quot;</span>: <span class="string">&quot;^6.22.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;chalk&quot;</span>: <span class="string">&quot;^1.1.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;connect-history-api-fallback&quot;</span>: <span class="string">&quot;^1.3.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;copy-webpack-plugin&quot;</span>: <span class="string">&quot;^4.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;css-loader&quot;</span>: <span class="string">&quot;^0.28.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint&quot;</span>: <span class="string">&quot;^3.19.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-friendly-formatter&quot;</span>: <span class="string">&quot;^2.0.7&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-loader&quot;</span>: <span class="string">&quot;^1.7.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-plugin-html&quot;</span>: <span class="string">&quot;^2.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-config-standard&quot;</span>: <span class="string">&quot;^6.2.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-plugin-promise&quot;</span>: <span class="string">&quot;^3.4.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint-plugin-standard&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eventsource-polyfill&quot;</span>: <span class="string">&quot;^0.9.6&quot;</span>,</span><br><span class="line">    <span class="string">&quot;express&quot;</span>: <span class="string">&quot;^4.14.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;extract-text-webpack-plugin&quot;</span>: <span class="string">&quot;^2.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file-loader&quot;</span>: <span class="string">&quot;^0.11.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;friendly-errors-webpack-plugin&quot;</span>: <span class="string">&quot;^1.1.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;html-webpack-plugin&quot;</span>: <span class="string">&quot;^2.28.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;http-proxy-middleware&quot;</span>: <span class="string">&quot;^0.17.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-bundle-analyzer&quot;</span>: <span class="string">&quot;^2.2.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;semver&quot;</span>: <span class="string">&quot;^5.3.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;shelljs&quot;</span>: <span class="string">&quot;^0.7.6&quot;</span>,</span><br><span class="line">    <span class="string">&quot;opn&quot;</span>: <span class="string">&quot;^4.0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;optimize-css-assets-webpack-plugin&quot;</span>: <span class="string">&quot;^1.3.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ora&quot;</span>: <span class="string">&quot;^1.2.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rimraf&quot;</span>: <span class="string">&quot;^2.6.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;url-loader&quot;</span>: <span class="string">&quot;^0.5.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-loader&quot;</span>: <span class="string">&quot;^12.1.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-style-loader&quot;</span>: <span class="string">&quot;^3.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vue-template-compiler&quot;</span>: <span class="string">&quot;^2.3.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack&quot;</span>: <span class="string">&quot;^2.6.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-dev-middleware&quot;</span>: <span class="string">&quot;^1.10.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-hot-middleware&quot;</span>: <span class="string">&quot;^2.18.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;webpack-merge&quot;</span>: <span class="string">&quot;^4.1.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;engines&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;node&quot;</span>: <span class="string">&quot;&gt;= 4.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;npm&quot;</span>: <span class="string">&quot;&gt;= 3.0.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;browserslist&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;&gt; 1%&quot;</span>,</span><br><span class="line">    <span class="string">&quot;last 2 versions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;not ie &lt;= 8&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样，我们在执行 cnpm start 及 cnpm run server 后即可分别启动前端和后端服务。项目目录如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── README.md</span><br><span class="line">├── build</span><br><span class="line">│   ├── build.js</span><br><span class="line">│   ├── check-versions.js</span><br><span class="line">│   ├── dev-client.js</span><br><span class="line">│   ├── dev-server.js</span><br><span class="line">│   ├── utils.js</span><br><span class="line">│   ├── vue-loader.conf.js</span><br><span class="line">│   ├── webpack.base.conf.js</span><br><span class="line">│   ├── webpack.dev.conf.js</span><br><span class="line">│   └── webpack.prod.conf.js</span><br><span class="line">├── config</span><br><span class="line">│   ├── dev.env.js</span><br><span class="line">│   ├── index.js</span><br><span class="line">│   └── prod.env.js</span><br><span class="line">├── index.html</span><br><span class="line">├── mongo.json</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── server  // 后端代码</span><br><span class="line">│   ├── app.js</span><br><span class="line">│   ├── bin</span><br><span class="line">│   ├── lib</span><br><span class="line">│   ├── routes</span><br><span class="line">│   └── service</span><br><span class="line">├── src</span><br><span class="line">│   ├── App.vue</span><br><span class="line">│   ├── assets</span><br><span class="line">│   ├── components</span><br><span class="line">│   ├── main.js</span><br><span class="line">│   └── router</span><br><span class="line">└── static</span><br></pre></td></tr></table></figure>

<p>这样项目的结构比较清晰。 遇到的问题：</p>
<ul>
<li>在开发阶段，vue运行与localhost:8080端口，express运行于localhost:3000端口。vue在跨域请求接口时会提示跨域请求不被允许。这里使用express的cros模块，允许8080端口的请求：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const cors = require(&#x27;cors&#x27;);  </span><br><span class="line">app.use(cors(&#123;  </span><br><span class="line">    origin:[&#x27;http://localhost:8080&#x27;],</span><br><span class="line">    methods:[&#x27;GET&#x27;,&#x27;POST&#x27;],</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>这样就解决了跨域请求问题。</p>
<ul>
<li>在 vue 请求后端接口时，我选用了vue官方推荐的 axios 作为http请求组件。涉及到登陆验证，所以 express 使用express-session及connect-redis模块，将session存在redis中。在登录成功后，将登录信息存储于 req.session.user 中，当有其他请求时，通过判断 req.session.user 来判断是否登录及登录是否过期。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);  </span><br><span class="line"><span class="keyword">const</span> redisStore = <span class="built_in">require</span>(<span class="string">&#x27;connect-redis&#x27;</span>)(session);  </span><br><span class="line">app.use(session(&#123;  </span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;backend123...&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;backend&#x27;</span>,</span><br><span class="line">    <span class="attr">store</span>: <span class="keyword">new</span> RedisStore(options),</span><br><span class="line">    <span class="attr">cookie</span>: &#123;</span><br><span class="line">        <span class="attr">maxAge</span>: <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>,</span><br><span class="line">    &#125;,<span class="comment">// 1h</span></span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">app.post(<span class="string">&#x27;/login&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;  </span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 登录成功，拿到用户信息，设置session</span></span><br><span class="line">    req.session.user = userinfo</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 有其他请求时判断登陆</span></span><br><span class="line">app.user(<span class="string">&#x27;*&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>(req.session.user)next() <span class="comment">// 如果session存在，是登录状态</span></span><br><span class="line">    <span class="keyword">else</span> .... <span class="comment">// 未登录</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>但是通过调试发现，每次登陆后用户信息确实存到session中了，但是下次请求时session却为空！最后发现是由于跨域问题引起的。由于使用了cros安全代理，默认是拒绝接收浏览器发送的cookie，所以每次请求都不带cookie，sessionID自然对不上，所以每次都会是新的session，导致没法保存登陆状态。给cors配置参数，允许接收cookie即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.use(cors(&#123;  </span><br><span class="line">    origin:[&#x27;http://localhost:8080&#x27;],</span><br><span class="line">    methods:[&#x27;GET&#x27;,&#x27;POST&#x27;],</span><br><span class="line">    credentials: true</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<p>但是加完了发现问题还是没有解决，那么就是 axios 的问题了，原来axios默认发送http请求时是不会在头信息中附带cookie的，所以也需要配置开启。直接在main.js中全局设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#x27;axios&#x27;    // axios  </span><br><span class="line">import VueAxios from &#x27;vue-axios&#x27;  </span><br><span class="line">axios.defaults.withCredentials = true    // 请求携带cookie信息  </span><br><span class="line">Vue.use(VueAxios, axios)  </span><br></pre></td></tr></table></figure>

<p>这样，问题终于解决了233…心累。 坑先填到这，持续更新。</p>
<p>github：<a target="_blank" rel="noopener" href="https://github.com/flute/webpackvue2expressmongodbbackend">https://github.com/flute/webpackvue2expressmongodbbackend</a></p>
<p>参考资料：<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/04/cors.html">http://www.ruanyifeng.com/blog/2016/04/cors.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-05-16T15:15:09.000Z" title="5/16/2017, 11:15:09 PM">2017-05-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-02-13T06:52:09.000Z" title="2/13/2018, 2:52:09 PM">2018-02-13</time></span><span class="level-item">13 minutes read (About 1895 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/05/16/%E5%9F%BA%E4%BA%8Eexpress%E7%9A%84%E5%A4%8D%E6%9D%82%E5%BA%94%E7%94%A8%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84%E5%88%86%E5%B1%82/">基于express的复杂应用——代码结构分层</a></h1><div class="content"><p>项目之初，我一般选择用 express 的脚手架工具 express-generator 生成目录结构，比较快捷，生成的文件结构也比较直观。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install express-generator -g // 全局安装  </span><br><span class="line">express -<span class="keyword">e</span> myapp // 创建工程，生成目录，使用ejs作为模板语言 </span><br></pre></td></tr></table></figure>

<p>生成的目录结构如下：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">├── app.js</span><br><span class="line">├── bin</span><br><span class="line">│   └── www</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   ├── images</span><br><span class="line">│   ├── javascripts</span><br><span class="line">│   └── stylesheets</span><br><span class="line">├── routes</span><br><span class="line">│   ├── <span class="built_in">index</span>.js</span><br><span class="line">│   └── users.js</span><br><span class="line">└── views</span><br><span class="line">    ├── error.ejs</span><br><span class="line">    ├── <span class="built_in">index</span>.ejs</span><br><span class="line">    └── layout.ejs</span><br></pre></td></tr></table></figure>

<ul>
<li>app.js 作为入口文件</li>
<li>public 存放静态资源</li>
<li>routes 存放路由文件</li>
<li>views 模板</li>
</ul>
<p>对于功能比较 单一/复杂度较低 的应用，我们只需要增加一个 models 文件夹，将逻辑与数据操作封装后放置其中，然后在路由文件中引入即可，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">routes/index.js:</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getIndexlists = <span class="built_in">require</span>(<span class="string">&#x27;../modals/getIndexlists&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/list&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </span><br><span class="line">    getIndexlists(req, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 向models中模块传递参数，利用回调函数得到结果,然后操作res</span></span><br><span class="line">        <span class="keyword">if</span>(!err) res.render(<span class="string">&#x27;list&#x27;</span>, result)</span><br><span class="line">        ....</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>models/getIndexlists.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);  </span><br><span class="line"><span class="keyword">const</span> conf = <span class="built_in">require</span>(<span class="string">&#x27;../conf/db.js&#x27;</span>);  </span><br><span class="line"><span class="comment">// 连接数据库</span></span><br><span class="line"><span class="keyword">const</span> pool = mysql.createPool( conf.mysql );</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">req, callback</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">let</span> id = req.params.id;</span><br><span class="line">    pool.getConnection(<span class="function"><span class="keyword">function</span>(<span class="params">err, connection</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            callback(err);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        connection.query(<span class="string">&#x27;select * from list where id=&#x27;</span>+<span class="string">&quot;id&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span>&#123;</span><br><span class="line">            <span class="comment">// 得到结果后回调</span></span><br><span class="line">            callback(err, result)</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//释放连接 </span></span><br><span class="line">         connection.release();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时的项目结构长这样：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">├── app.js</span><br><span class="line">├── bin</span><br><span class="line">│   └── www</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   ├── images</span><br><span class="line">│   ├── javascripts</span><br><span class="line">│   └── stylesheets</span><br><span class="line">├── routes</span><br><span class="line">│   └── <span class="built_in">index</span>.js</span><br><span class="line">├── models</span><br><span class="line">│   └── getIndexlists.js</span><br><span class="line">└── views</span><br><span class="line">    └── <span class="keyword">list</span></span><br></pre></td></tr></table></figure>

<p>对于路由较为简单，功能较少的应用，这样分离路由与数据操作已经够用了。但是我们会发现，上述的示例中，路由直接传递参数给 model，model 与进项数据操作后直接返回结果给 route，然后 route 直接拿数据渲染 view 模板。然而通常我们拿到数据后需要对数据进行一系列的处理，或者是进行多个表的数据操作，将结果整合，从而得到我们期待的数据结构。那么这些操作我们应该放在那里呢，放在 model 中明显不合理，因为这明显不与数据库操作挂钩，那么放在 route 文件中呢？看着好像还可以。 这时我们的 route 文件大概是这样：</p>
<p>routes/index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">async</span> = <span class="built_in">require</span>(<span class="string">&#x27;async&#x27;</span>);  </span><br><span class="line"><span class="keyword">const</span> getIndexlists = <span class="built_in">require</span>(<span class="string">&#x27;../modals/getIndexlists&#x27;</span>),  </span><br><span class="line">      getUserInfo = <span class="built_in">require</span>(<span class="string">&#x27;../modals/getIndexlists&#x27;</span>)，</span><br><span class="line">      ...;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/list&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </span><br><span class="line">        <span class="comment">// 多任务</span></span><br><span class="line">        <span class="keyword">async</span>.parallel(&#123;</span><br><span class="line">           <span class="attr">list</span>: <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">                getIndexlists(req, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span>&#123;</span><br><span class="line">                    <span class="comment">// 拿到数据，进行格式处理后返回</span></span><br><span class="line">                    result.data = result.data.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> item+<span class="number">1</span>;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .....</span><br><span class="line">                    callback(err, result)</span><br><span class="line">                &#125;)</span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">user</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                getUserInfo(req, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span>&#123;</span><br><span class="line">                    ....数据处理</span><br><span class="line">                    ....数据处理</span><br><span class="line">                    callback(err, result)</span><br><span class="line">                &#125;)</span><br><span class="line">           &#125;</span><br><span class="line">           ...其余操作 </span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span>&#123;</span><br><span class="line">            <span class="comment">//最终返回结果</span></span><br><span class="line">            <span class="keyword">if</span>(!err)&#123;</span><br><span class="line">                res.render(<span class="string">&#x27;list&#x27;</span>, result);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>这时候我们的路由文件实际上已经变的臃肿了，不仅处理路由信息，还要处理多任务数据操作及数据格式问题，这样的形式写的再多一点，route 文件就很混乱了。这时候我们就会想把（任务处理、数据处理）逻辑处理给抽出来，放到 services 文件夹中，形成 route-service-model 的结构，route 负责单一的路由处理，service 负责逻辑处理，model 负责数据访问。这样每个文件各司其职，代码结构就会比较清晰。将 service 抽离出来的另一个好处是——可复用性，实际上很多数据处理的格式相同，我们可以把这些相同的操作封装到一个 service 文件中，在需要的地方直接调用即可，同理，对于 model 中的数据操作，我们也可以将常用的增删改查操作封装起来，提高代码的复用性。</p>
<p>这时我们的代码结构长这样：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">├── app.js</span><br><span class="line">├── bin</span><br><span class="line">│   └── www</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   ├── images</span><br><span class="line">│   ├── javascripts</span><br><span class="line">│   └── stylesheets</span><br><span class="line">├── routes</span><br><span class="line">│   └── <span class="built_in">index</span>.js</span><br><span class="line">├── models</span><br><span class="line">│   └── getIndexlists.js</span><br><span class="line">├── services</span><br><span class="line">│   └── dealListData.js</span><br><span class="line">└── views</span><br><span class="line">    └── <span class="keyword">list</span></span><br></pre></td></tr></table></figure>

<p>到此为止，我们的代码结构已经很清晰了，基本实现了高复用，低耦合的理念。 那么当我们的应用进一步复杂，我们的系统可能有好多功能模块，几十个路由，这时候出现的问题就是路由文件泰国庞大，所有的路由都集中在一个路由文件中，阅读调试起来相当不便。这是我们会想到将路由进行二级分化，主路由进行大方向的路由控制，将同一功能模块（路由相似）的路由集中到一个路由文件中。我们把自路由控制文件放置于 controller 文件夹中，这样路由的控制实际是 route-controller 这样的二次处理，减轻了主路由的负担，提高代码的可维护性与可读性。 到此为止，我们的express应用的运行流程是：route-controller-service-model</p>
<p>这样，即便是复杂的 express 应用，也会分解的条理清晰。当然在实际项目中我们还需要日志显示，那么我们最终的项目结构因该是长这样：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── app.js</span><br><span class="line">├── bin</span><br><span class="line">│   └── www</span><br><span class="line">├── <span class="keyword">conf</span></span><br><span class="line">│   ├── db.js</span><br><span class="line">│   └── <span class="built_in">log</span>.js</span><br><span class="line">├── controllers</span><br><span class="line">│   ├── indexController.js</span><br><span class="line">│   ├── homeController.js</span><br><span class="line">│   ├── userController.js</span><br><span class="line">│   ├── pageController.js</span><br><span class="line">│   └── resultController.js</span><br><span class="line">├── logs</span><br><span class="line">├── models</span><br><span class="line">│   ├── analyze.js</span><br><span class="line">│   ├── create.js</span><br><span class="line">│   ├── <span class="keyword">list</span>.js</span><br><span class="line">│   └── result.js</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   ├── fonts</span><br><span class="line">│   ├── images</span><br><span class="line">│   ├── javascripts</span><br><span class="line">│   ├── stylesheets</span><br><span class="line">│   └── uploads</span><br><span class="line">├── routes</span><br><span class="line">│   └── <span class="built_in">index</span>.js</span><br><span class="line">├── service</span><br><span class="line">│   ├── delResult.js</span><br><span class="line">│   ├── delUser.js</span><br><span class="line">│   ├── getAnalyze.js</span><br><span class="line">│   ├── getIndexLists.js</span><br><span class="line">│   ├── mysql.js</span><br><span class="line">│   ├── publishArticle.js</span><br><span class="line">│   ├── ssoLogin.js</span><br><span class="line">│   └── upload.js</span><br><span class="line">└── views</span><br><span class="line">    ├── <span class="built_in">index</span></span><br><span class="line">    ├── home</span><br><span class="line">    ├── user</span><br><span class="line">    ├── page</span><br><span class="line">    └── common</span><br></pre></td></tr></table></figure>

<p>经验之谈，说的不对的地方，望大家指正。</p>
<p><strong>附：创建二级路由</strong><br><strong>express.Router</strong><br>可使用<code>express.Router</code>类创建模块化、可挂载的路由句柄。<code>Router</code>实例是一个完整的中间件和路由系统，因此常称其为一个 “mini-app”。</p>
<p>下面的实例程序创建了一个二级路由模块，定义了一些路由，并且将它们挂载至应用的主路由上。</p>
<p>二级路由<code>controllers/birds.js</code>内容如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);  </span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义网站主页的路由</span></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </span><br><span class="line">  res.send(<span class="string">&#x27;Birds home page&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 定义 about 页面的路由</span></span><br><span class="line">router.get(<span class="string">&#x27;/about&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </span><br><span class="line">  res.send(<span class="string">&#x27;About birds&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;  </span><br></pre></td></tr></table></figure>
<p>主路由<code>routes/index.js</code>内容：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> birds = <span class="built_in">require</span>(<span class="string">&#x27;./birds&#x27;</span>);  </span><br><span class="line">...</span><br><span class="line">app.use(<span class="string">&#x27;/birds&#x27;</span>, birds);  </span><br></pre></td></tr></table></figure>
<p>应用即可处理发自<code>/birds</code>和<code>/birds/about</code>的请求。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-03-19T20:42:24.000Z" title="3/20/2017, 4:42:24 AM">2017-03-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2017-03-19T20:42:24.000Z" title="3/20/2017, 4:42:24 AM">2017-03-20</time></span><span class="level-item">2 minutes read (About 329 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/03/20/SASS/">SASS</a></h1><div class="content"><h2 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h2><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul>
<li>install ruby</li>
<li>sudo gem install sass<h4 id="申明变量"><a href="#申明变量" class="headerlink" title="申明变量"></a>申明变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$value = 100px;</span><br><span class="line">$color = #fafafa;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h4><p><code>sass style.scss style.css</code></p>
<p>编译风格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* nested：嵌套缩进的css代码，它是默认值。</span><br><span class="line">* expanded：没有缩进的、扩展的css代码。</span><br><span class="line">* compact：简洁格式的css代码。</span><br><span class="line">* compressed：压缩后的css代码。</span><br><span class="line">sass --style compressed style.scss build.css</span><br></pre></td></tr></table></figure>
<p>监听文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// watch a file</span><br><span class="line">sass --watch input.scss:output.css</span><br><span class="line">// watch a directory</span><br><span class="line">sass --watch app/sass:public/stylesheets</span><br></pre></td></tr></table></figure>

<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>直接使用变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$color:#fafafa;</span><br><span class="line">.div&#123;</span><br><span class="line">    background:$color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>变量嵌套在字符串中，需要写在<code>#&#123;&#125;</code>中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$side:left,</span><br><span class="line">.border&#123;</span><br><span class="line">    border-#&#123;$side&#125;-color:$color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="计算功能"><a href="#计算功能" class="headerlink" title="计算功能"></a>计算功能</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//除法需要加括号</span><br><span class="line">margin:(14px/2); //7px</span><br><span class="line">left:15px + 14; //29px</span><br><span class="line">width:$var * (1/3) * 1%; //33.3%</span><br></pre></td></tr></table></figure>

<h4 id="嵌套"><a href="#嵌套" class="headerlink" title="嵌套"></a>嵌套</h4><ul>
<li>选择器嵌套<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.container&#123;</span><br><span class="line">    header&#123;</span><br><span class="line">        height:30px;</span><br><span class="line">    &#125;</span><br><span class="line">    footer&#123;</span><br><span class="line">        display:block;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>属性嵌套<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p&#123;</span><br><span class="line">    border:&#123;//border后需加冒号</span><br><span class="line">        width:2px;</span><br><span class="line">        style:solid;</span><br><span class="line">        color:$var;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="代码复用"><a href="#代码复用" class="headerlink" title="代码复用"></a>代码复用</h4><ul>
<li>继承<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.div1&#123;</span><br><span class="line">    width:20px;</span><br><span class="line">    height:30px;</span><br><span class="line">&#125;</span><br><span class="line">.div2&#123;</span><br><span class="line">    @extend .div1;</span><br><span class="line">    background:#fafafa;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Mixin<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@mixin border&#123;</span><br><span class="line">    border-left:1px solid #233;</span><br><span class="line">&#125;</span><br><span class="line">#box&#123;</span><br><span class="line">    @include border;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">传递参数</span><br><span class="line">@mixin size($height:30px)&#123;</span><br><span class="line">    display:inline-block;</span><br><span class="line">    height:$height;</span><br><span class="line">    width:100px;</span><br><span class="line">&#125;</span><br><span class="line">#box&#123;</span><br><span class="line">    @include size(50px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="导入外部文件"><a href="#导入外部文件" class="headerlink" title="导入外部文件"></a>导入外部文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;path/style.scss&quot;</span><br><span class="line">@import &quot;path/main.css&quot;</span><br></pre></td></tr></table></figure>

<h4 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">div&#123;</span><br><span class="line">    @if 1&lt;2 &#123;</span><br><span class="line">        width:100%;</span><br><span class="line">    &#125;</span><br><span class="line">    @if 1&gt;5 &#123;</span><br><span class="line">        width:50%;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">main&#123;</span><br><span class="line">    @if $width&gt;100&#123;</span><br><span class="line">        height:50px;</span><br><span class="line">    &#125;@else&#123;</span><br><span class="line">        height:20px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h4><ul>
<li>for<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@for $i from 1 to 10&#123;</span><br><span class="line">    .box-#&#123; $i &#125;&#123;</span><br><span class="line">        border:#&#123;$i&#125;px solid blue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>while<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$i: 6;</span><br><span class="line">@while $i &gt; 0 &#123;</span><br><span class="line">    .item-#&#123;$i&#125; &#123; width: 2em * $i; &#125;</span><br><span class="line">    $i: $i - 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>each<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@each $item in left,right,top,bottom&#123;</span><br><span class="line">    .box&#123;</span><br><span class="line">        border-#&#123;$item&#125;:1px solid #333;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@function setWidth($width:100px)&#123;</span><br><span class="line">    @return $width*2</span><br><span class="line">&#125;</span><br><span class="line">.box&#123;</span><br><span class="line">    width:setWidth(20px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-12-31T00:11:05.000Z" title="12/31/2016, 8:11:05 AM">2016-12-31</time></span><span class="level-item">Updated&nbsp;<time dateTime="2017-03-19T20:50:53.000Z" title="3/20/2017, 4:50:53 AM">2017-03-20</time></span><span class="level-item">10 minutes read (About 1496 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/12/31/2016%E6%80%BB%E7%BB%93/">2016总结</a></h1><div class="content"><h2 id="2016"><a href="#2016" class="headerlink" title="2016"></a>2016</h2><p>过去的这一年，算是一个转折点吧，学生时代的终结，开始工作了。毕业后的几个月，也会经常想起上学时的很多美好，日常用语也多了句“我在学校的时候…”，我想所有刚离校的同学有共感，毕竟伴随了16年的读书模式要转换了，虽然在学校时也会出去做外包，去实习，但当全职工作后还是很回念学生时代。</p>
<p>说是16年的年度总结，其实多半是下半年的一些变化。以前我觉得总结什么的，都是给别人看的，形式主义。但工作的半年我转变了自己的看法，我尝试在工作的每周、每月梳理下，在每个时间段内，自己学到的新东西以及欠缺的东西，这样就有一种看着自己不断成长的感觉。不然你可能只是觉得自己好像增长了，好像有些问题被人诟病，但有不明确的知道哪些点增长了，哪些还在拖后腿。</p>
<p>既然是贴着程序猿的标签，那年度总结就分为生活和技术两部分吧：</p>
<h4 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h4><ol>
<li>虽然学的是自动化专业，但是转战互联网其实从大二就开始了，虽然家里人都希望去稳定的国企，但他们也尊重我的选择，所以毕业后之久投身IT行业有惊无险。前半年的毕业找工作期也是经历了很多波折，换了好几个offer。。虽然一波三折，但是吃一堑长一智，记得任何时候都有必要签书面合同！！！不要因为对方是熟人而口头承诺！！！这是对自己的基本保障。</li>
<li>get 自己理发技能，从6月份开始远离理发店，到目前已经半年时间自行理发了，虽然插曲不断，总归做了件自己一直想做的事~</li>
<li>复习巩固做饭技能，高中有时候自己做饭，但基本是以面食为主，菜很少做。上了大学就完全荒废了，这半年尝试了一些新菜，现在有朋友来可以上桌招待了，会做饭可以大幅提高生活的幸福度！</li>
<li>体重还是持续在125-130之间徘徊，这个状况持续了五六年了…是真的吃不胖了，明年换个方式增重</li>
<li>买到了自己想买的东西，这里我采用而一个不错的方法：每月20%的工资拿出来消费，可以预支，但预支额度不超过一年总额。例如月薪10k，想买个8k的相机，那么你得攒4个月的消费额，本年度最多购买2.4w的物品。</li>
<li>看了很多好看的电影、美国、国产电视剧，《权利的游戏》又得等一年，《黑客军团》第二季就看了几集，没时间看…《西部世界》追着看完了，很不错。《长城》虽然剧情让人诟病，但创新值得肯定，我支持一票。最近在看《鬼吹灯之精绝古城》，作为七卷小说都看完的老粉，很满意。还有很多看的东西，不一一评价了。</li>
</ol>
<h4 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h4><ol>
<li>毕业前一直在纠结前端和php选哪个，最终投身JS大坑，远离了最好的语言php，事实上我觉的这个选择很正确</li>
<li>读了《JS权威指南》《JS编程艺术》《响应式web设计》，虽然js写的依旧烂，但现在对JS有了亲切感</li>
<li>React Native：做了半个ios app，做了半个主要是时间不过，创业公司大家都懂。但主要的RN组件基本都用过了，可以用RN开发简单的APP了。</li>
<li>Electron：基于framework7框架做了两个webApp，然后用electron打包了Mac和Windows两个平台的包，这个算是今年做的最久也最满意的作品，对electron用的比较熟悉了。</li>
<li>Nodejs：基于express、MySQL、material design做了一个调查问卷系统，入坑nodejs后端开发</li>
<li>项目中用到的一些东西：<ul>
<li>环信WebIm即时通讯：自己根据SDK手写了包括聊天、图片、文件传输、localstorage做聊天存储等，虽然过程艰苦，但很享受。</li>
<li>百度地图、鹰眼轨迹：项目中用到很多，基于地图做了无数二次开发…我感觉项目中一般功能是基于地图的2333：实时位置、历史轨迹、区域分化、区域/点绘制等</li>
<li>Echarts3：由于要做一部分数据可视化，研究了下D3.js，学习曲线有点高，就转战Echarts3，强行改造Echarts3+百度地图map做实时报警信息的展示。讲道理，echarts真的是用来展示静态数据的，搞动态数据展示真的是遭天谴。</li>
<li>用了framework7、metarial deaigin两个前端框架，framework7也是基本上用烂了，比较熟悉。metarial deaigin是真的好看，可惜IE兼容性有问题。</li>
</ul>
</li>
</ol>
<h2 id="2017"><a href="#2017" class="headerlink" title="2017"></a>2017</h2><ul>
<li>健身、健身、健身</li>
<li>增重、增重、增重</li>
<li>多做好吃的</li>
<li>留长发？待定…</li>
<li>多看些除技术之外的书</li>
<li>买一些好玩的东西</li>
<li>敲至少三个 JS 源码，继续全栈之路</li>
<li>看电影、电视剧</li>
<li>出去浪</li>
<li>人际关系？就这样吧，懒得管理…</li>
</ul>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">Previous</a></div><div class="pagination-next"><a href="/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/18/">18</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://img.ikstatic.cn/MTYzMTE3MTU3NDM3MCM1MzYjcG5n.png" alt="Ludis"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Ludis</p><p class="is-size-6 is-block">Valar Morghulis, Valar Dohaeris</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">177</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">17</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/flute" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/flute"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/3852099619"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:552452006@qq.com"><i class="far fa-envelope"></i></a></div></div></div><!--!--><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-30T07:42:16.000Z">2021-06-30</time></p><p class="title"><a href="/2021/06/30/React-Antd-Warning%E7%A7%BB%E9%99%A4%E5%A4%A7%E6%B3%95%E2%80%94%E2%80%94%E6%95%B4%E4%B8%AA%E4%B8%96%E7%95%8C%E6%B8%85%E5%87%80%E4%BA%86/">React/Antd Warning移除大法——整个世界清净了</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-14T10:41:14.000Z">2020-05-14</time></p><p class="title"><a href="/2020/05/14/IntersectionObserver/">IntersectionObserver</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-02-06T13:45:55.000Z">2020-02-06</time></p><p class="title"><a href="/2020/02/06/%E5%BE%AE%E5%B1%81%E6%81%A9%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E4%B9%8B-%E2%80%94%E2%80%94-V2Ray/">微屁恩使用指南之 —— V2Ray</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-10T07:45:26.000Z">2019-12-10</time></p><p class="title"><a href="/2019/12/10/H5%E5%9C%A8%E5%85%A8%E5%B1%8FWebview%E4%B8%AD%E5%8F%8C%E7%AB%AF%E9%80%82%E9%85%8D%E5%88%98%E6%B5%B7%E5%B1%8F/">H5在全屏Webview中双端适配刘海屏</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-07-25T09:58:45.000Z">2019-07-25</time></p><p class="title"><a href="/2019/07/25/vue-%E9%A1%B9%E7%9B%AE%E5%9C%A8%E4%BD%8E%E9%85%8D%E6%9C%BA%E5%99%A8%E4%B8%8A%E7%BA%BF%E5%8F%8A%E4%BC%98%E5%8C%96/">vue 项目在低配机器上线及优化</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">October 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">March 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">March 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">December 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">November 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">October 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/09/"><span class="level-start"><span class="level-item">September 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/08/"><span class="level-start"><span class="level-item">August 2016</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/07/"><span class="level-start"><span class="level-item">July 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/02/"><span class="level-start"><span class="level-item">February 2016</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/12/"><span class="level-start"><span class="level-item">December 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/11/"><span class="level-start"><span class="level-item">November 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/10/"><span class="level-start"><span class="level-item">October 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/09/"><span class="level-start"><span class="level-item">September 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/08/"><span class="level-start"><span class="level-item">August 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/07/"><span class="level-start"><span class="level-item">July 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/06/"><span class="level-start"><span class="level-item">June 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/05/"><span class="level-start"><span class="level-item">May 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/04/"><span class="level-start"><span class="level-item">April 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/03/"><span class="level-start"><span class="level-item">March 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/02/"><span class="level-start"><span class="level-item">February 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/01/"><span class="level-start"><span class="level-item">January 2015</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/12/"><span class="level-start"><span class="level-item">December 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/11/"><span class="level-start"><span class="level-item">November 2014</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/10/"><span class="level-start"><span class="level-item">October 2014</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/09/"><span class="level-start"><span class="level-item">September 2014</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/08/"><span class="level-start"><span class="level-item">August 2014</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/07/"><span class="level-start"><span class="level-item">July 2014</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/06/"><span class="level-start"><span class="level-item">June 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/05/"><span class="level-start"><span class="level-item">May 2014</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/04/"><span class="level-start"><span class="level-item">April 2014</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/03/"><span class="level-start"><span class="level-item">March 2014</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/02/"><span class="level-start"><span class="level-item">February 2014</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/01/"><span class="level-start"><span class="level-item">January 2014</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/12/"><span class="level-start"><span class="level-item">December 2013</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/11/"><span class="level-start"><span class="level-item">November 2013</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/10/"><span class="level-start"><span class="level-item">October 2013</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Flutter/"><span class="tag">Flutter</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ghost/"><span class="tag">Ghost</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/H5/"><span class="tag">H5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTTPS/"><span class="tag">HTTPS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac/"><span class="tag">Mac</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/React-Native/"><span class="tag">React Native</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sublime/"><span class="tag">Sublime</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jQuery/"><span class="tag">jQuery</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs/"><span class="tag">nodejs</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/npm/"><span class="tag">npm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%88%AC%E8%99%AB/"><span class="tag">爬虫</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E8%A7%86%E5%89%A7/"><span class="tag">电视剧</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BE%8E%E9%A3%9F/"><span class="tag">美食</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9A%8F%E7%AC%94/"><span class="tag">随笔</span><span class="tag">3</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/facvion.png" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2021 Ludis</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/flute"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>